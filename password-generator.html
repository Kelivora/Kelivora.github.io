<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>密码生成器</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500;600;700&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #faf9f7;
      --bg-secondary: #f5f3f0;
      --bg-tertiary: #efeae5;
      --text-primary: #1a1a18;
      --text-secondary: #8a8a83;
      --text-muted: #aca9a2;
      --accent: #c4a574;
      --accent-light: #e8dcc8;
      --accent-dark: #a08050;
      --success: #4a7c59;
      --warning: #d4a574;
      --danger: #c45c5c;
      --border: rgba(0, 0, 0, 0.06);
      --border-subtle: rgba(0, 0, 0, 0.04);
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.08);
      --shadow-glow: 0 0 40px rgba(196, 165, 116, 0.15);
      --radius-sm: 12px;
      --radius-md: 20px;
      --radius-lg: 28px;
      --font-display: 'Noto Serif SC', Georgia, serif;
      --font-body: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-mono: 'Outfit', 'SF Mono', monospace;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-body);
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      -webkit-font-smoothing: antialiased;
      background-image:
        radial-gradient(ellipse 80% 50% at 50% -20%, rgba(196, 165, 116, 0.03), transparent),
        radial-gradient(ellipse 60% 40% at 80% 60%, rgba(196, 165, 116, 0.02), transparent);
    }

    .container {
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      padding: 36px;
      box-shadow: var(--shadow-lg), var(--shadow-glow);
      max-width: 420px;
      width: 100%;
      border: 1px solid var(--border-subtle);
      position: relative;
      overflow: hidden;
    }

    .container::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: var(--radius-lg);
      padding: 1px;
      background: linear-gradient(135deg, var(--accent-light) 0%, transparent 50%);
      -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      pointer-events: none;
    }

    h1 {
      text-align: center;
      font-family: var(--font-display);
      font-size: 1.6rem;
      font-weight: 600;
      margin-bottom: 28px;
      color: var(--text-primary);
      letter-spacing: 0.02em;
    }

    .password-display {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      padding: 18px 60px 18px 18px;
      margin-bottom: 20px;
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .password-display:focus-within {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(196, 165, 116, 0.1);
    }

    #password {
      font-family: var(--font-mono);
      font-size: 15px;
      color: var(--text-primary);
      word-break: break-all;
      min-height: 24px;
      font-weight: 500;
      letter-spacing: 0.05em;
    }

    .copy-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: linear-gradient(135deg, #c4a574 0%, #a08050 100%);
      border: none;
      padding: 8px 18px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      color: white;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(196, 165, 116, 0.3);
    }

    .copy-btn:hover {
      transform: translateY(-50%) translateY(-2px);
      box-shadow: 0 4px 16px rgba(196, 165, 116, 0.4);
    }

    .copy-btn.copied {
      background: linear-gradient(135deg, #4a7c59 0%, #3d6549 100%);
      box-shadow: 0 4px 16px rgba(74, 124, 89, 0.3);
    }

    .strength-meter {
      margin-bottom: 26px;
    }

    .strength-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    #strength-text {
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: 0.02em;
    }

    .strength-bar {
      height: 6px;
      background: var(--bg-secondary);
      border-radius: 3px;
      overflow: hidden;
      border: 1px solid var(--border-subtle);
    }

    .strength-fill {
      height: 100%;
      width: 0%;
      border-radius: 3px;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .strength-fill.weak { background: var(--danger); width: 25%; }
    .strength-fill.fair { background: var(--warning); width: 50%; }
    .strength-fill.good { background: var(--accent); width: 75%; }
    .strength-fill.strong { background: var(--success); width: 100%; }

    .length-section {
      margin-bottom: 26px;
    }

    .length-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 14px;
    }

    .length-header label {
      font-weight: 500;
      color: var(--text-primary);
      font-size: 0.95rem;
    }

    #length-value {
      font-family: var(--font-mono);
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--accent);
      min-width: 48px;
      text-align: right;
      line-height: 1;
    }

    #length {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: var(--bg-secondary);
      border-radius: 3px;
      outline: none;
      border: 1px solid var(--border-subtle);
      cursor: pointer;
    }

    #length::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 22px;
      height: 22px;
      background: var(--bg-primary);
      border: 2px solid var(--accent);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(196, 165, 116, 0.2);
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #length::-webkit-slider-thumb:hover {
      transform: scale(1.15);
      box-shadow: 0 4px 16px rgba(196, 165, 116, 0.3);
    }

    #length::-moz-range-thumb {
      width: 22px;
      height: 22px;
      background: var(--bg-primary);
      border: 2px solid var(--accent);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(196, 165, 116, 0.2);
    }

    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 26px;
    }

    .option {
      display: flex;
      align-items: center;
      padding: 14px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .option:hover {
      border-color: var(--accent-light);
      background: var(--bg-tertiary);
      transform: translateY(-1px);
    }

    .option input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-right: 12px;
      cursor: pointer;
      accent-color: var(--accent);
      border-radius: 4px;
    }

    .option label {
      cursor: pointer;
      font-size: 0.85rem;
      color: var(--text-primary);
      white-space: nowrap;
      font-weight: 400;
    }

    .generate-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #c4a574 0%, #a08050 100%);
      color: white;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 16px rgba(196, 165, 116, 0.3);
      letter-spacing: 0.02em;
    }

    .generate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 24px rgba(196, 165, 116, 0.4);
    }

    .generate-btn:active {
      transform: translateY(0);
    }

    .history {
      margin-top: 26px;
      padding-top: 22px;
      border-top: 1px solid var(--border-subtle);
    }

    .history h3 {
      font-family: var(--font-display);
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--text-muted);
      margin-bottom: 14px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .history-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 120px;
      overflow-y: auto;
    }

    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      font-family: var(--font-mono);
      font-size: 0.8rem;
      border: 1px solid var(--border-subtle);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .history-item:hover {
      border-color: var(--accent-light);
    }

    .history-item span:first-child {
      color: var(--text-primary);
      word-break: break-all;
      margin-right: 12px;
      font-weight: 500;
    }

    .history-item span:last-child {
      color: var(--text-muted);
      font-size: 0.7rem;
      white-space: nowrap;
      font-weight: 400;
    }

    @media (max-width: 420px) {
      .container {
        padding: 28px 20px;
      }

      .options {
        grid-template-columns: 1fr;
      }

      h1 {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>密码生成器</h1>

    <div class="password-display">
      <div id="password">点击生成按钮创建密码</div>
      <button class="copy-btn" onclick="copyPassword()">复制</button>
    </div>

    <div class="strength-meter">
      <div class="strength-label">
        <span>密码强度</span>
        <span id="strength-text">-</span>
      </div>
      <div class="strength-bar">
        <div class="strength-fill" id="strength-fill"></div>
      </div>
    </div>

    <div class="length-section">
      <div class="length-header">
        <label>密码长度</label>
        <span id="length-value">16</span>
      </div>
      <input type="range" id="length" min="8" max="64" value="16">
    </div>

    <div class="options">
      <div class="option">
        <input type="checkbox" id="uppercase" checked>
        <label for="uppercase">大写字母</label>
      </div>
      <div class="option">
        <input type="checkbox" id="lowercase" checked>
        <label for="lowercase">小写字母</label>
      </div>
      <div class="option">
        <input type="checkbox" id="numbers" checked>
        <label for="numbers">数字</label>
      </div>
      <div class="option">
        <input type="checkbox" id="symbols" checked>
        <label for="symbols">特殊符号</label>
      </div>
    </div>

    <button class="generate-btn" onclick="generatePassword()">生成密码</button>

    <div class="history">
      <h3>生成历史</h3>
      <div class="history-list" id="history-list"></div>
    </div>
  </div>

  <script>
    const lengthSlider = document.getElementById('length');
    const lengthValue = document.getElementById('length-value');
    const passwordDisplay = document.getElementById('password');
    const strengthText = document.getElementById('strength-text');
    const strengthFill = document.getElementById('strength-fill');
    const historyList = document.getElementById('history-list');

    let passwordHistory = JSON.parse(localStorage.getItem('passwordHistory') || '[]');

    lengthSlider.addEventListener('input', () => {
      lengthValue.textContent = lengthSlider.value;
    });

    function getCharSets() {
      return {
        uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
        lowercase: 'abcdefghijklmnopqrstuvwxyz',
        numbers: '0123456789',
        symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
      };
    }

    function calculateEntropy(password) {
      let charsetSize = 0;
      if (/[a-z]/.test(password)) charsetSize += 26;
      if (/[A-Z]/.test(password)) charsetSize += 26;
      if (/[0-9]/.test(password)) charsetSize += 10;
      if (/[^a-zA-Z0-9]/.test(password)) charsetSize += 32;
      const entropy = password.length * Math.log2(charsetSize || 1);
      return entropy;
    }

    function getStrengthLevel(entropy) {
      if (entropy < 40) return { level: 'weak', text: '弱', className: 'weak' };
      if (entropy < 60) return { level: 'fair', text: '一般', className: 'fair' };
      if (entropy < 80) return { level: 'good', text: '良好', className: 'good' };
      return { level: 'strong', text: '强', className: 'strong' };
    }

    function updateStrengthMeter(password) {
      const entropy = calculateEntropy(password);
      const { level, text, className } = getStrengthLevel(entropy);
      strengthText.textContent = text;
      strengthFill.className = 'strength-fill ' + className;
    }

    function generatePassword() {
      const length = parseInt(lengthSlider.value);
      const useUppercase = document.getElementById('uppercase').checked;
      const useLowercase = document.getElementById('lowercase').checked;
      const useNumbers = document.getElementById('numbers').checked;
      const useSymbols = document.getElementById('symbols').checked;

      let charset = '';
      let requiredChars = [];

      if (useUppercase) {
        charset += getCharSets().uppercase;
        requiredChars.push(getCharSets().uppercase[Math.floor(Math.random() * 26)]);
      }
      if (useLowercase) {
        charset += getCharSets().lowercase;
        requiredChars.push(getCharSets().lowercase[Math.floor(Math.random() * 26)]);
      }
      if (useNumbers) {
        charset += getCharSets().numbers;
        requiredChars.push(getCharSets().numbers[Math.floor(Math.random() * 10)]);
      }
      if (useSymbols) {
        charset += getCharSets().symbols;
        requiredChars.push(getCharSets().symbols[Math.floor(Math.random() * getCharSets().symbols.length)]);
      }

      if (charset === '') {
        passwordDisplay.textContent = '请至少选择一个字符类型';
        return;
      }

      let password = [...requiredChars];
      for (let i = password.length; i < length; i++) {
        password.push(charset[Math.floor(Math.random() * charset.length)]);
      }

      for (let i = password.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [password[i], password[j]] = [password[j], password[i]];
      }

      const finalPassword = password.join('');
      passwordDisplay.textContent = finalPassword;
      updateStrengthMeter(finalPassword);
      addToHistory(finalPassword);
    }

    function addToHistory(password) {
      const timestamp = new Date().toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
      passwordHistory.unshift({ password, timestamp });
      passwordHistory = passwordHistory.slice(0, 10);
      localStorage.setItem('passwordHistory', JSON.stringify(passwordHistory));
      renderHistory();
    }

    function renderHistory() {
      if (passwordHistory.length === 0) {
        historyList.innerHTML = '<div style="text-align: center; color: var(--text-muted); padding: 12px; font-size: 0.85rem; font-style: italic;">暂无记录</div>';
        return;
      }
      historyList.innerHTML = passwordHistory.map(item => `
        <div class="history-item">
          <span>${item.password}</span>
          <span>${item.timestamp}</span>
        </div>
      `).join('');
    }

    async function copyPassword() {
      const password = passwordDisplay.textContent;
      if (!password || password === '点击生成按钮创建密码') return;

      const btn = document.querySelector('.copy-btn');
      btn.textContent = '复制中...';

      try {
        await navigator.clipboard.writeText(password);
        btn.textContent = '已复制';
        btn.classList.add('copied');
      } catch (err) {
        // 备用方案
        const textArea = document.createElement('textarea');
        textArea.value = password;
        textArea.style.position = 'fixed';
        textArea.style.opacity = '0';
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        btn.textContent = '已复制';
        btn.classList.add('copied');
      }

      setTimeout(() => {
        btn.textContent = '复制';
        btn.classList.remove('copied');
      }, 2000);
    }

    document.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') generatePassword();
    });

    renderHistory();
    generatePassword();
  </script>
</body>
</html>
