<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Python实时爬虫：自动抓取并推送学校最新通知 | 颗粒的运维手册</title><meta name="author" content="keli"><meta name="copyright" content="keli"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1.背景与目标  在出成绩之前，我们需要时刻关注报考学校的最新通知，以免错过重要信息。然而，手动刷新网页的方式既耗时又费力。为此，我们可以利用Python爬虫技术，实现学校最新通知的实时爬取与推送，确保信息获取的及时性与准确性。2.推送方式选择  要实现通知的实时推送，我们需要选择一个合适的推送方式。经过对比，我发现虾推啥（https:&#x2F;&#x2F;www.xtuis.cn&#x2F;）这一公众号推送方式非常适合">
<meta property="og:type" content="article">
<meta property="og:title" content="Python实时爬虫：自动抓取并推送学校最新通知">
<meta property="og:url" content="http://example.com/2024/08/12/python_spider_new/index.html">
<meta property="og:site_name" content="颗粒的运维手册">
<meta property="og:description" content="1.背景与目标  在出成绩之前，我们需要时刻关注报考学校的最新通知，以免错过重要信息。然而，手动刷新网页的方式既耗时又费力。为此，我们可以利用Python爬虫技术，实现学校最新通知的实时爬取与推送，确保信息获取的及时性与准确性。2.推送方式选择  要实现通知的实时推送，我们需要选择一个合适的推送方式。经过对比，我发现虾推啥（https:&#x2F;&#x2F;www.xtuis.cn&#x2F;）这一公众号推送方式非常适合">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:published_time" content="2024-08-12T02:26:28.014Z">
<meta property="article:modified_time" content="2024-04-28T06:04:37.000Z">
<meta property="article:author" content="keli">
<meta property="article:tag" content="python爬虫">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><link rel="shortcut icon" href="/img/icon.png"><link rel="canonical" href="http://example.com/2024/08/12/python_spider_new/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python实时爬虫：自动抓取并推送学校最新通知',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-04-28 14:04:37'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="颗粒的运维手册"><span class="site-name">颗粒的运维手册</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Python实时爬虫：自动抓取并推送学校最新通知</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-12T02:26:28.014Z" title="发表于 2024-08-12 10:26:28">2024-08-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-28T06:04:37.000Z" title="更新于 2024-04-28 14:04:37">2024-04-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"></div></div></div><article class="post-content" id="article-container"><meta name="referrer" content="no-referrer" />

<p><strong>1.背景与目标</strong><br>  在出成绩之前，我们需要时刻关注报考学校的最新通知，以免错过重要信息。然而，手动刷新网页的方式既耗时又费力。为此，我们可以利用Python爬虫技术，实现学校最新通知的实时爬取与推送，确保信息获取的及时性与准确性。<br><strong>2.推送方式选择</strong><br>  要实现通知的实时推送，我们需要选择一个合适的推送方式。经过对比，我发现虾推啥（<a target="_blank" rel="noopener" href="https://www.xtuis.cn/">https://www.xtuis.cn/</a>）这一公众号推送方式非常适合我们的需求。通过关注公众号并获取个人token，可以轻松实现文字通知的实时推送，确保微信能够及时收到重要信息。<br><strong>3.爬虫执行频率设置</strong><br>  为了避免对目标网站造成过大的访问压力，需要合理设置爬虫的执行频率。考虑到信息的时效性和访问的合理性，我建议将爬取速度设置为每小时一次。这样既能保证及时获取最新通知，又能避免对网站造成过大的负担。<br><strong>4.爬虫部署位置选择</strong><br>  为了实现24小时不间断的自动爬取与推送功能，需要选择一个合适的部署位置。考虑到本地设备的限制和实时推送的需求，我建议将爬虫部署在云服务器上。阿里云服务器是一个不错的选择，经过学生认证和测试，可以免费使用两个月，轻松搭建起自己的爬虫环境。<br><strong>5.实施步骤</strong></p>
<ol>
<li><strong>注册并获取虾推啥token</strong>：首先，关注虾推啥公众号并注册账号，获取个人token，以便后续实现推送功能。</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354686835-f806931b-e1bb-42a8-a11b-017918ad779a.png#averageHue=%23f5f5f5&clientId=u79fe1332-9459-4&from=drop&height=228&id=u0e6a2133&originHeight=677&originWidth=959&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=84090&status=done&style=none&taskId=u94bf624c-0813-4bed-b3db-82d7a78509c&title=&width=323.5090026855469" alt="image001.png"></p>
<ol start="2">
<li><strong>编写Python爬虫代码</strong>：使用Python编写爬虫代码，包括请求学校网站、解析网页内容、提取最新通知等步骤。确保爬虫能够准确获取所需信息。</li>
</ol>
<p>（1）打开需要解析的网页，找到第一篇文章，右键单击“检查”选项。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354848535-53a72db6-e993-491e-a2b7-545de42ed132.png#averageHue=%23f7f5f5&clientId=u79fe1332-9459-4&from=paste&height=271&id=uf712f238&originHeight=376&originWidth=737&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=43546&status=done&style=none&taskId=u35b69a6c-4bd3-4859-8458-b751b29e33c&title=&width=531.1711529166023" alt="image.png"><br>（2）开始分析网页内容，可以看到p中有 class&#x3D;”newscontent” ，span中存放的是文章的日期，a中的href存放的是网页链接。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354905208-052fc036-151c-42ea-9713-a5307364c49f.png#averageHue=%23f7f5f4&clientId=u79fe1332-9459-4&from=drop&id=u926a4e15&originHeight=479&originWidth=1133&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=29076&status=done&style=none&taskId=u96f63981-d6aa-4ea0-aebc-f8c2d96cf94&title=" alt="image003.png"><br>（3）编写爬虫代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义要爬取的网页URL  </span></span><br><span class="line">url = <span class="string">&quot;https://zs.gpnu.edu.cn/bkzn/a2023sefdzsb.htm&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 定义基础URL，用于拼接相对链接以形成完整的URL  </span></span><br><span class="line">bs_url = <span class="string">&quot;https://zs.gpnu.edu.cn/&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 导入requests库，用于发送HTTP请求  </span></span><br><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 使用requests库的get方法发送GET请求到指定的URL  </span></span><br><span class="line">r = requests.get(url)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 设置响应内容的编码为utf-8，确保中文内容能够正确显示  </span></span><br><span class="line">r.encoding = <span class="string">&quot;utf-8&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 检查请求是否成功（HTTP状态码是否为200）  </span></span><br><span class="line"><span class="keyword">if</span> r.status_code != <span class="number">200</span>:  </span><br><span class="line">    <span class="comment"># 如果请求不成功，则抛出一个异常  </span></span><br><span class="line">    <span class="keyword">raise</span> Exception()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取响应的文本内容  </span></span><br><span class="line">html_doc = r.text  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 导入BeautifulSoup库，用于解析HTML文档  </span></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 使用BeautifulSoup库解析HTML文档  </span></span><br><span class="line">soup = BeautifulSoup(html_doc, <span class="string">&quot;html.parser&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 查找所有class为&quot;newscontent&quot;的&lt;p&gt;标签  </span></span><br><span class="line">dev_nodes = soup.find_all(<span class="string">&quot;p&quot;</span>, class_=<span class="string">&quot;newscontent&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 遍历每一个找到的&lt;p&gt;标签  </span></span><br><span class="line"><span class="keyword">for</span> dev_node <span class="keyword">in</span> dev_nodes:  </span><br><span class="line">    <span class="comment"># 在当前&lt;p&gt;标签中查找&lt;a&gt;标签，通常&lt;a&gt;标签包含链接  </span></span><br><span class="line">    link = dev_node.find(<span class="string">&quot;a&quot;</span>)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment"># 在当前&lt;p&gt;标签中查找&lt;span&gt;标签，通常用于存放日期信息  </span></span><br><span class="line">    date = dev_node.find(<span class="string">&quot;span&quot;</span>)  </span><br><span class="line">      </span><br><span class="line">    <span class="comment"># 打印拼接后的完整链接（使用基础URL加上相对链接，并去掉链接开头的三个字符，为了去掉某些特殊字符或路径），链接的文本以及日期信息  </span></span><br><span class="line">    <span class="built_in">print</span>(bs_url + link[<span class="string">&quot;href&quot;</span>][<span class="number">3</span>:], link.get_text(), date.get_text())</span><br></pre></td></tr></table></figure>
<p>（4）尝试在pycharm中运行代码，输出为以下内容。将网页中所有文章的网址、标题、日期全部输出出来了。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354915167-7ff8d69c-ef4a-41be-9267-d9d43900497d.png#averageHue=%23f5f3f1&clientId=u79fe1332-9459-4&from=drop&id=u2a938b2c&originHeight=685&originWidth=1586&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=410081&status=done&style=none&taskId=u16c6c4f5-6ba6-4ea6-9d16-91d027d628a&title=" alt="image005.png"></p>
<ol start="3">
<li><strong>实现推送功能</strong>：在爬虫代码中集成推送功能，将获取到的最新通知通过公众号推送给用户。</li>
</ol>
<p>（1）使用datetime模块获取当日信息，并将其格式化为带方括号的字符串形式，比较今日日期与网页上的日期是否一致，如果日期匹配则是成绩出了。无论日期是否匹配，代码都会发送一个默认的GET请求到另一个URL，通知用户成绩还未出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取当前系统日期和时间  </span></span><br><span class="line">now = datetime.now()  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 将当前日期格式化为 &quot;yyyy-mm-dd&quot; 的格式，并在前后加上方括号  </span></span><br><span class="line">formatted_date = <span class="string">f&quot;[<span class="subst">&#123;now.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span>]&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 假设 date.get_text() 是一个函数，它返回一个与 formatted_date 格式相同的日期字符串</span></span><br><span class="line"><span class="comment"># 比较格式化后的当前日期与网页中的日期是否一致  </span></span><br><span class="line"><span class="keyword">if</span> formatted_date == date.get_text():  </span><br><span class="line">    <span class="comment"># 如果日期一致，则打印出链接的完整URL、链接文本和日期信息   </span></span><br><span class="line">    <span class="built_in">print</span>(bs_url + link[<span class="string">&quot;href&quot;</span>][<span class="number">3</span>:], link.get_text(), date.get_text())  </span><br><span class="line">    <span class="comment"># 准备发送 POST 请求的数据，通知有新公告  </span></span><br><span class="line">    mydata = &#123;  </span><br><span class="line">        <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;有新公告！有可能是成绩出了&#x27;</span>,  <span class="comment"># 通知的标题  </span></span><br><span class="line">        <span class="string">&#x27;desp&#x27;</span>: <span class="string">&#x27;内容:&#x27;</span> + link.get_text() + <span class="string">&#x27;&lt;br&gt;&#x27;</span> \  <span class="comment"># 通知的描述，包含公告内容  </span></span><br><span class="line">                <span class="string">&#x27;网址:&#x27;</span> + bs_url + link[<span class="string">&quot;href&quot;</span>][<span class="number">3</span>:] + <span class="string">&#x27;&lt;br&gt;&#x27;</span> \  <span class="comment"># 公告的链接  </span></span><br><span class="line">                <span class="string">&#x27;日期:&#x27;</span> + date.get_text()  <span class="comment"># 公告的日期  </span></span><br><span class="line">    &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment"># 发送 POST 请求到指定的 URL，通知服务有新公告  </span></span><br><span class="line">    requests.post(<span class="string">&#x27;https://wx.xtuis.cn/你的token.send&#x27;</span>, data=mydata)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 无论日期是否匹配，都发送一个 GET 请求通知用户成绩还未出（可不写，当成绩出了才发送）</span></span><br><span class="line">requests.get(<span class="string">&#x27;https://wx.xtuis.cn/你的token.send?text=成绩还没出哦，请耐心等待&amp;desp=成绩未出&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><strong>部署爬虫到云服务器</strong>：将编写好的爬虫代码部署到阿里云服务器上，确保服务器能够24小时运行。</li>
</ol>
<p>（1）打开阿里云服务器（<a target="_blank" rel="noopener" href="https://www.aliyun.com/">https://www.aliyun.com/</a>）<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354942534-f0619e4f-7012-4f62-9fcb-907883a2174e.png#averageHue=%23f0f1f1&clientId=u79fe1332-9459-4&from=drop&id=u2c7f3c8e&originHeight=916&originWidth=1878&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=413848&status=done&style=none&taskId=u1ba64f54-0672-4f1f-93cf-2dc58500b21&title=" alt="image007.png"><br>（2）学生可以领取免费的服务器使用，这里我以轻量服务器为例，查找轻量服务器<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354946943-667f4c60-d22d-45b7-b16a-07455f242802.png#averageHue=%23d9b17e&clientId=u79fe1332-9459-4&from=drop&id=u5aed92c8&originHeight=728&originWidth=1293&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=58919&status=done&style=none&taskId=u6b5ac569-eba9-4623-a4b4-c03a6ab815d&title=" alt="image009.png"><br>（3）选择轻量服务器<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354951335-f4f967b1-d9e0-4ee1-b229-0c20b6a2cc79.png#averageHue=%23f9ebe1&clientId=u79fe1332-9459-4&from=drop&id=u3450ee0b&originHeight=700&originWidth=1710&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=122634&status=done&style=none&taskId=u0d521dff-0876-4aa2-834d-c570c350b8d&title=" alt="image011.png"><br>（4）设置服务器配置<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354954566-7a52672e-c4ad-465f-ba92-1f98e259eb27.png#averageHue=%23fdfcfb&clientId=u79fe1332-9459-4&from=drop&id=udcdc7bcd&originHeight=1908&originWidth=1899&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=255813&status=done&style=none&taskId=uf4a4f59e-852e-46b3-a725-74648611bb0&title=" alt="image013.png"><br>（5）转到服务台查看服务器ip地址。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354961197-4c168d15-270d-47b7-b87f-f336d948d62a.png#averageHue=%23fcf7f7&clientId=u79fe1332-9459-4&from=drop&height=439&id=ue1483a99&originHeight=849&originWidth=837&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=51031&status=done&style=none&taskId=u925eb95e-c96d-433d-8f34-d839fb0f0e3&title=&width=433.0090026855469" alt="image015.png"><br>（6）使用远程连接工具连接<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354964784-8fbeb15f-d653-4614-becf-dd928622d0f1.png#averageHue=%23f9f8f8&clientId=u79fe1332-9459-4&from=drop&height=506&id=u7e8a38fd&originHeight=845&originWidth=883&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=61319&status=done&style=none&taskId=u2321e562-7e3f-4ef7-b230-dec498c72e3&title=&width=529.0134887695312" alt="image017.png"><br>（7）登录到你的云服务器后，执行宝塔面板安装命令，阿里云服务器网使用的CentOS操作系统，命令如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su</span><br><span class="line">yum install -y wget &amp;&amp; wget -O install.sh https://download.bt.cn/install/install_6<span class="number">.0</span>.sh &amp;&amp; sh install.sh ed8484bec</span><br></pre></td></tr></table></figure>
<p>执行宝塔Linux面板安装命令后，会提示如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Do you want to install Bt-Panel to the /www directory now?(y/n): y</span><br></pre></td></tr></table></figure>
<p>保持默认，回复个字母“y”，如下图：<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354970865-c63a371c-7f04-490b-8086-7bdeee970e92.png#averageHue=%23232221&clientId=u79fe1332-9459-4&from=drop&id=uea0a1bd9&originHeight=292&originWidth=1024&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=36655&status=done&style=none&taskId=ufafe1d51-9c1c-47a6-871f-c0cee96c9b9&title=" alt="image019.png"><br>（8）安装好后会有提示IP地址、用户名、密码和端口号。在阿里云中开放端口号。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711354985903-5ba6d1d2-b525-4152-85fd-d5dc3e18dabb.png#averageHue=%23fcfaf4&clientId=u79fe1332-9459-4&from=drop&id=u2b7313ac&originHeight=823&originWidth=1607&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=88235&status=done&style=none&taskId=ufe114bbd-c4ea-4394-a0e5-a8a3ddd03d0&title=" alt="image023.png"><br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711355000263-66c15604-0de0-4254-b13a-73571a523352.png#averageHue=%23f8f7f7&clientId=u79fe1332-9459-4&from=drop&id=u63760765&originHeight=355&originWidth=1332&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=20542&status=done&style=none&taskId=u0fc1d00c-1282-46b4-a683-a7ffee1afdb&title=" alt="image025.png"><br>（9）输入外网面板地址，使用账号密码登录。网页提示安装LNMP，确认并安装好LNMP组件。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711355004670-63d5a6df-73f2-4ec0-83c0-0deb42c73d3a.png#averageHue=%23fdfcfc&clientId=u79fe1332-9459-4&from=drop&id=u1452e5ba&originHeight=580&originWidth=1268&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=88606&status=done&style=none&taskId=u304e1fda-926d-403b-abe7-fce15a0ce3c&title=" alt="image027.png"><br>（10）安装所需要的BeautifulSoup库，并在命令行中编辑好Python代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install beautifulsoup4</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">vim /root/main.py</span><br><span class="line">url = <span class="string">&quot;https://zs.gpnu.edu.cn/bkzn/a2023sefdzsb.htm&quot;</span></span><br><span class="line">bs_url= <span class="string">&quot;https://zs.gpnu.edu.cn/&quot;</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">r = requests.get(url)</span><br><span class="line">r.encoding = <span class="string">&quot;utf-8&quot;</span></span><br><span class="line"><span class="keyword">if</span> r.status_code != <span class="number">200</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception()</span><br><span class="line">html_doc = r.text</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">soup =BeautifulSoup(html_doc, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">dev_nodes= soup.find_all(<span class="string">&quot;p&quot;</span>,class_=<span class="string">&quot;newscontent&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> dev_node <span class="keyword">in</span> dev_nodes:</span><br><span class="line">    link = dev_node.find(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">    date=dev_node.find(<span class="string">&quot;span&quot;</span>)</span><br><span class="line">    <span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">    now = datetime.now()</span><br><span class="line">    formatted_date = <span class="string">f&quot;[<span class="subst">&#123;now.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)&#125;</span>]&quot;</span></span><br><span class="line">    <span class="keyword">if</span> formatted_date == date.get_text():</span><br><span class="line">        <span class="built_in">print</span>(bs_url + link[<span class="string">&quot;href&quot;</span>][<span class="number">3</span>:], link.get_text(), date.get_text())</span><br><span class="line">        mydata = &#123;</span><br><span class="line">            <span class="string">&#x27;text&#x27;</span>: <span class="string">&#x27;有新公告！有可能是成绩出了&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;desp&#x27;</span>: <span class="string">&#x27;内容:&#x27;</span> + link.get_text() + <span class="string">&#x27;&lt;br&gt;&#x27;</span> \</span><br><span class="line">            <span class="string">&#x27;网址:&#x27;</span> + bs_url + link[<span class="string">&quot;href&quot;</span>][<span class="number">3</span>:] + <span class="string">&#x27;&lt;br&gt;&#x27;</span> \</span><br><span class="line">            <span class="string">&#x27;日期:&#x27;</span> +  date.get_text()</span><br><span class="line">        &#125;</span><br><span class="line">        requests.post(<span class="string">&#x27;https://wx.xtuis.cn/你的token.send&#x27;</span>, data=mydata)</span><br><span class="line">requests.get(<span class="string">&#x27;https://wx.xtuis.cn/你的token.send?text=成绩还没出哦，请耐心等待&amp;desp=成绩未出&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><strong>设置爬虫执行频率</strong>：在Linux中设置合理的执行频率，如每小时执行一次。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line"><span class="number">0</span> * * * *  python3 /root/main.py</span><br></pre></td></tr></table></figure>
这样便完成了一个完整的自动抓取并推送学校最新通知的实践流程。<br><img src="https://cdn.nlark.com/yuque/0/2024/png/43111799/1711356125734-d5b27471-2bdb-4e61-97b3-1f05d1e9a9f4.png#averageHue=%23f6f6f6&clientId=u79fe1332-9459-4&from=paste&height=141&id=ue0e3139e&originHeight=195&originWidth=412&originalType=binary&ratio=1.3875000476837158&rotation=0&showTitle=false&size=7531&status=done&style=none&taskId=uaabc223a-581c-41dd-aa04-9167b1adffc&title=&width=296.9369267322119" alt="image.png"></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">keli</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/08/12/python_spider_new/">http://example.com/2024/08/12/python_spider_new/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">颗粒的运维手册</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python%E7%88%AC%E8%99%AB/">python爬虫</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/12/superset_pk_metabase/" title="superset与metabase调研比较"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">superset与metabase调研比较</div></div></a></div><div class="next-post pull-right"><a href="/2024/08/12/k8s_Gitlab_start/" title="CI/CD:基于kubernetes的Gitlab搭建"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CI/CD:基于kubernetes的Gitlab搭建</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">keli</div><div class="author-info__description">运维手记</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">练习时长两年半</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/12/MySQL_install/" title="MySQL 8.0的三种安装方式">MySQL 8.0的三种安装方式</a><time datetime="2024-08-12T02:26:28.014Z" title="发表于 2024-08-12 10:26:28">2024-08-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/12/superset_install/" title="superset部署与实践">superset部署与实践</a><time datetime="2024-08-12T02:26:28.014Z" title="发表于 2024-08-12 10:26:28">2024-08-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/12/python_50/" title="python编程50例">python编程50例</a><time datetime="2024-08-12T02:26:28.014Z" title="发表于 2024-08-12 10:26:28">2024-08-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/12/superset_pk_metabase/" title="superset与metabase调研比较">superset与metabase调研比较</a><time datetime="2024-08-12T02:26:28.014Z" title="发表于 2024-08-12 10:26:28">2024-08-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/12/python_spider_new/" title="Python实时爬虫：自动抓取并推送学校最新通知">Python实时爬虫：自动抓取并推送学校最新通知</a><time datetime="2024-08-12T02:26:28.014Z" title="发表于 2024-08-12 10:26:28">2024-08-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By keli</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>